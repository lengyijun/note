# Mmap

Mmap的核心有两点:
1. 磁盘直接到用户态内存,不经过内核态内存,少一次复制
2. 按需读取,用缺页终端读取

mmap打开一个文件时,什么也不会发生,就给个一段连续的虚拟内存地址

等你具体要用哪一个页了,会触发缺页中断,然后把文件的那个页读进来.

操作系统依然可能会把mmap进来的页扔掉,在内存紧张的时候(?)

Mmap相当于操作系统给你做了缓存(cache)

## Mmap vs fopen

1. 少一次内存复制


## 缺点

缺页中断次数太多.某些场合你可能受不了缺页中断的延迟,那只能一次性全读到内存了

